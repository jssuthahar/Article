# ğŸ“˜ Azure Cosmos DB Table API â€“ Entity, PartitionKey, and RowKey Explained

## ğŸ§¾ Overview

In **Azure Cosmos DB Table API**, data is stored as **entities** (similar to rows in a table), and each entity is uniquely identified using two required properties:

* ğŸ”‘ **PartitionKey** â€“ used for data distribution and scalability
* ğŸ†” **RowKey** â€“ the unique identifier **within a partition**

Together, `PartitionKey` + `RowKey` form a **unique primary key** for each entity in a table.

---

## ğŸ“¦ What is an Entity?

An **entity** in Table API is a structured data object like a row in a relational table or a document.
It contains:

* A **PartitionKey** (string)
* A **RowKey** (string)
* A **Timestamp** (auto-managed)
* Optional **custom properties** (Name, Email, etc.)

```json
{
  "PartitionKey": "HR",
  "RowKey": "E001",
  "Name": "John Doe",
  "Email": "john.doe@company.com",
  "Timestamp": "2025-07-05T09:00:00Z"
}
```

---

## ğŸ§© PartitionKey â€“ What and Why?

* Groups **related entities** together
* Enables **scalable reads/writes** and efficient partitioning
* Used by Cosmos DB to **distribute load** across storage partitions

ğŸ’¡ Best Practice: Choose a PartitionKey that balances size and query access (e.g., department, region, category).

---

## ğŸ†” RowKey â€“ What and Why?

* The **unique ID** for the entity within a partition
* Often used as the entityâ€™s unique ID (like Employee ID, Product ID)

---

## ğŸ§  Real-Time Examples

### ğŸ“ Example 1: Employee Records

| PartitionKey | RowKey | Name      | Department |
| ------------ | ------ | --------- | ---------- |
| HR           | E001   | John Doe  | HR         |
| HR           | E002   | Priya Rao | HR         |
| IT           | E001   | Alex Chen | IT         |

* `PartitionKey`: department (`HR`, `IT`)
* `RowKey`: employee ID (`E001`, `E002`)
* âœ… Allows querying: â€œGet all employees in HRâ€ or â€œGet employee E001 in ITâ€

---

### ğŸ“¦ Example 2: E-commerce Orders

| PartitionKey | RowKey   | Product  | Price |
| ------------ | -------- | -------- | ----- |
| CUST001      | ORDER001 | Laptop   | 1200  |
| CUST001      | ORDER002 | Keyboard | 100   |
| CUST002      | ORDER001 | Monitor  | 250   |

* `PartitionKey`: Customer ID
* `RowKey`: Order ID
* âœ… Enables fast query: â€œAll orders for CUST001â€

---

### ğŸ“… Example 3: IoT Sensor Data

| PartitionKey | RowKey               | SensorType | Value |
| ------------ | -------------------- | ---------- | ----- |
| Device001    | 2025-07-05T08:00:00Z | Temp       | 30.5  |
| Device001    | 2025-07-05T08:01:00Z | Temp       | 30.6  |

* `PartitionKey`: Device ID
* `RowKey`: Timestamp
* âœ… Enables time-series queries per device

---

## ğŸ› ï¸ How to Create Entity in .NET

```csharp
using Azure.Data.Tables;

var entity = new TableEntity("HR", "E001")
{
    { "Name", "John Doe" },
    { "Role", "Manager" }
};

await tableClient.AddEntityAsync(entity);
```

---

## âœ… Tips for Choosing Keys

| Goal                         | Suggested PartitionKey | Suggested RowKey      |
| ---------------------------- | ---------------------- | --------------------- |
| Group by category            | Category name          | Unique item ID        |
| Per-user data (e.g., orders) | User ID                | Order ID or timestamp |
| Time-based logs              | Device ID              | ISO Timestamp string  |

---

## â—Important Notes

* Both `PartitionKey` and `RowKey` are **required**
* Values are **case-sensitive**
* Combined they must be **unique** per entity
* Cosmos DB **automatically indexes** both fields

---

## ğŸ“š References

* [Table API Overview â€“ Microsoft Docs](https://learn.microsoft.com/en-us/azure/cosmos-db/table/table-overview)
* [Azure.Data.Tables SDK](https://learn.microsoft.com/en-us/dotnet/api/azure.data.tables)

## Connect with Me
- **LinkedIn**: [Suthahar Jeganathan](https://www.linkedin.com/in/jssuthahar/)
- **YouTube**: [MSDEVBUILD](https://www.youtube.com/@MSDEVBUILD)
- **YouTube Tamil**: [MSDEVBUILD TAMIL](https://www.youtube.com/@MSDEVBUILDTamil)
- **Blog**: [Blog](https://www.msdevbuild.com/)
- **Follow Whatsapp**: [Whatsapp](https://www.whatsapp.com/channel/0029Va5j2rHEFeXcTlUhQB0J)
