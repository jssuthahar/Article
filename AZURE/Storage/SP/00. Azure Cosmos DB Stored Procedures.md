# üìò Azure Cosmos DB Stored Procedures 

This guide explains **how to create, read, update, and delete items** in Azure Cosmos DB using **stored procedures written in JavaScript**. These examples are kept very simple with **no error handling** to help beginners understand easily.

---

## üìå Before You Start

* Stored procedures run on the **server-side**
* They are written in **JavaScript**
* They work only within **one partition key**
* Each stored procedure must be deployed to a **container**

---

## ‚úÖ 1. Create Item ‚Äì `createItem`

```javascript
function createItem(doc) {
    var context = getContext();
    var collection = context.getCollection();
    var response = context.getResponse();

    collection.createDocument(collection.getSelfLink(), doc, function (err, createdDoc) {
        response.setBody(createdDoc);
    });
}
```

‚û°Ô∏è This creates a new item (`doc`) in the container and returns it.

---

## ‚úÖ 2. Read Item by ID ‚Äì `readItemById`

```javascript
function readItemById(id) {
    var context = getContext();
    var collection = context.getCollection();
    var response = context.getResponse();

    var query = `SELECT * FROM c WHERE c.id = "${id}"`;

    collection.queryDocuments(collection.getSelfLink(), query, {}, function (err, documents) {
        response.setBody(documents[0]);
    });
}
```

‚û°Ô∏è This reads the first item that matches the given `id`.

---

## ‚úÖ 3. Update Item ‚Äì `updateItem`

```javascript
function updateItem(id, newName) {
    var context = getContext();
    var collection = context.getCollection();
    var response = context.getResponse();

    var query = `SELECT * FROM c WHERE c.id = "${id}"`;

    collection.queryDocuments(collection.getSelfLink(), query, {}, function (err, docs) {
        var doc = docs[0];
        doc.name = newName;

        collection.replaceDocument(doc._self, doc, function (err, updatedDoc) {
            response.setBody(updatedDoc);
        });
    });
}
```

‚û°Ô∏è This finds an item by `id`, changes the `name`, and saves it.

---

## ‚úÖ 4. Delete Item ‚Äì `deleteItemById`

```javascript
function deleteItemById(id) {
    var context = getContext();
    var collection = context.getCollection();
    var response = context.getResponse();

    var query = `SELECT * FROM c WHERE c.id = "${id}"`;

    collection.queryDocuments(collection.getSelfLink(), query, {}, function (err, docs) {
        var doc = docs[0];
        collection.deleteDocument(doc._self, {}, function (err, result) {
            response.setBody("Deleted");
        });
    });
}
```

‚û°Ô∏è This finds an item by `id` and deletes it.

---

## üß™ Test from .NET SDK (Example)

```csharp
var result = await container.Scripts.ExecuteStoredProcedureAsync<dynamic>(
    "createItem",
    new PartitionKey("Books"),
    new dynamic[] { new { id = "101", name = "Simple Book", category = "Books" } }
);
```

## Connect with Me
- **LinkedIn**: [Suthahar Jeganathan](https://www.linkedin.com/in/jssuthahar/)
- **YouTube**: [MSDEVBUILD](https://www.youtube.com/@MSDEVBUILD)
- **YouTube Tamil**: [MSDEVBUILD TAMIL](https://www.youtube.com/@MSDEVBUILDTamil)
- **Blog**: [Blog](https://www.msdevbuild.com/)
- **Follow Whatsapp**: [Whatsapp](https://www.whatsapp.com/channel/0029Va5j2rHEFeXcTlUhQB0J)
